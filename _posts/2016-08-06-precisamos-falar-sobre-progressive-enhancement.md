---
layout: post
title: "Precisamos falar sobre Progressive Enhancement"
description: "Precisamos falar sobre Progressive Enhancement"
date: 2016-08-07 14:30:00
categories: web development
published: true
---

**Progressive Enhancement** √© uma forma de pensar o desenvolvimento de aplica√ß√µes web com foco no front-end de uma forma que as melhorias sejam progressivas, como o nome sugere. N√£o ficou claro?! N√£o esquenta! Vamos decifrar o que esses conceitos significam e como aplic√°-los nos seus projetos. ü§ò

>**Nota do autor:** Este texto √© uma compila√ß√£o envolvendo anota√ß√µes e transcri√ß√µes do segundo cap√≠tulo do e-book "ColetaÃÇnea Front-end - Uma Antologia da Comunidade Front-end Brasileira" que fala sobre Progressive Enhancement e que foi escrito pelo [Luiz Real](https://twitter.com/srsaude), instrutor da Alura.

Quando trata-se do comportamento de aplica√ß√µes desenvolvidas para a web, todo cuidado passa a ser pouco. Com navegadores mais modernos e compat√≠veis com as atuais tecnologias e especifica√ß√µes, tornou-se poss√≠vel a abrang√™ncia de mais recursos, ampliando as possibilidades dos desenvolvedores. Seguindo est√° tend√™ncia, o ciclo natural seria que nossos sites tamb√©m evoluissem, tornando-se cada vez mais sofisticados. 

Por√©m, dentro deste cen√°rio, acabamos esquecendo um fator primordial para o sucesso: o comportamento do usu√°rio e o navegador que eles utilizam para acessar nossos sites, que muitas vezes n√£o √© o navegador com os √∫ltimos recursos.

Normalmente, quando planejamentos o desenvolvimento de um site acabamos fazendo-o para um p√∫blico indeterminado de pessoas. E dentre esse p√∫blico, temos:

- Pessoas que **n√£o gostam de JavaScript** sendo executado em seus computadores;

- Pessoas que **n√£o podem atualizar** seus navegadores;

- Pessoas acessando a internet a partir de **dispositivos limitados**;

- Pessoas com **dificuldades motoras, visuais e auditivas** que nem sempre conseguem utilizar o mouse para navegar ou dependem de leitores de tela;

- E ainda temos um outro usu√°rio a considerar, que n√£o tem JavasSript nem CSS habilitados: **as ferramentas de busca**.

### Ent√£o como podemos desenvolver sites levando em conta estes cen√°rios?


Em um primeiro momento, uma forma de pensar seria desenvolver o site para o p√∫blico geral, que s√£o aqueles que tem acesso aos navegadores mais modernos e atualizados e sem bloqueios de acessibilidade. Em um segundo momento, procuraria-se atender os usu√°rios que j√° possuem mais limita√ß√µes, ou seja, definindo os tipos de usu√°rios e quais implementa√ß√µes s√£o necess√°rias a cada fase do projeto para suprir as suas necessidades. Dentro do mundo de desenvolvimento web, essa pr√°tica √© conhecida como **"Graceful Degradation"**.

Por√©m, pensar dessa forma pode nos levar a alguns problemas, como no exemplo a seguir dado pelo **Luiz Real**(ver nota do autor):

>Pegamos como exemplo para analisar: um bot√£o de comprar em uma loja virtual. A compra foi implementada usando AJAX, para dar mais dinamicidade √† navega√ß√£o do usu√°rio.

```html
<input type="hidden" name="produto" value="123456">
<input type="number" name="quantidade">
<a href="#" id="comprar"><img src="icone-comprar.png"></a>
```

```js
$("#comprar").click(function() {
    var dadosCompra = {
        produto: $("[name=produto]").val(),
        quantidade: $("[name=quantidade]").val()
    };

    // Enviamos os dados no formato JSON para o servidor.
    // atualizaPagina eÃÅ uma funcÃßaÃÉo que vai ser executada depois que o servidor confirmar a compra.

    $.post("/compra", dadosCompra, atualizaPagina, "json");
});
```

- A quais problemas essa solu√ß√£o n√£o atende?

A primeira coisa que podemos pensar √© na acessibilidade da p√°gina: ser√° que os usu√°rios com defici√™ncia visual conseguir√£o comprar nessa loja virtual? Provavelmente n√£o. Afinal, o bot√£o de comprar exemplificado √© uma imagem! O leitor de tela n√£o vai ser capaz de ler o texto "comprar" da imagem. 

Uma forma de melhoria seria trabalhar com um HTML mais sem√¢ntico:

```html
<form>
    <input type="hidden" name="produto" value="123456">
    <input type="number" name="quantidade">
    <button type="submit" id="comprar">
        <img src="icone-comprar.png" alt="Comprar">
    </button>
</form>
```

A tag `form`, como sabemos, serve para indicar que as informa√ß√µes presentes ser√£o enviadas para um servidor. H√° tamb√©m a tag `button` com o tipo `submit`, que indica que essa imagem √© um bot√£o e que ao ser clicado enviar√° o formul√°rio.

Tendo a preocupacÃßaÃÉo com **Graceful Degradation**, precisamos lembrar de todos os cenaÃÅrios que deixamos de lado ao desenvolver nosso site com as uÃÅltimas tecnologias.

Agora, imagine uma situa√ß√£o onde precisamos implementar uma solucÃßaÃÉo sem JavaScript. SeraÃÅ que eÃÅ possiÃÅvel? Pelo servidor nos devolver um JSON como resultado, e naÃÉo uma paÃÅgina, **precisamos** de JavaScript, agora. Ou seja, por termos desenvolvido uma solucÃßaÃÉo sem pensar nos casos mais limitados, acabamos caindo em um beco sem saiÃÅda. Precisando ent√£o **refazer boa parte da nossa soluc√£o**, inclusive do lado do servidor.

- Como fazer para n√£o corrermos o risco de esquecermos estes cen√°rios mais limitados durante o desenvolvimento de nossas aplica√ß√µes? ü§î

**Come√ßando exatamente por eles!** Essa √© a ideia do **Progressive Enhancement**. 


## Progressive Enhancement

Com essa breve contextualiza√ß√£o dos cen√°rios que enfrentamos durante o desenvolvimento dos nossos projetos web, agora podemos entrar mais a fundo nos conceitos de Progressive Enhancement. 

Para compreender a diferen√ßa entre **Graceful Degradation** e **Progressive Enhancement**, vamos tomar como exemplo o mesmo cen√°rio de antes: precisamos implementar o bot√£o para comprar um produto em uma loja virtual.

Qual seria ent√£o o nosso cen√°rio mais limitado? Bom, um navegador baseado em texto j√° √© um come√ßo. Neste tipo de navegador, a √∫nica ferramenta que temos dipon√≠vel √© o HTML.

- Como implementar√≠amos o bot√£o de compra utilizando apenas HTML? Com algo similar ao que j√° t√≠nhamos:

```html
<form action="/comprar" id="comprar">
    <input type="hidden" name="produto" value="123456">
    <input type="number" name="quantidade">
    <button type="submit">Comprar</button>
</form>
```

O interessante de se observar nesta implementa√ß√£o, √© o uso do atributo `action` no formul√°rio. Ele faz com que o navegador saiba para qual endere√ßo no servidor os dados do formul√°rio devem ser enviados. Assim, n√£o precisamos de JavaScript nenhum para fazer o navegador entender isso.

Outro ponto interessante, √© a inser√ß√£o do texto "Comprar" dentro de um bot√£o em vez de uma imagem. Essa decis√£o al√©m de tratar a quest√£o dos navegadores baseados em texto, tamb√©m se mostra compat√≠vel com os leitores de telas utilizados pelos usu√°rios com defici√™ncia visual. 

Tamb√©m vale ressaltar que a decis√£o de come√ßar pelo cen√°rio mais limitado influencia tamb√©m o lado servidor da aplica√ß√£o: o formato dos dados enviados ser√£o o padr√£o do navegador e n√£o no formado JSON.

- Para implementar a nossa compra com AJAX, como quer√≠amos anteriormente, podemos escrever o seguinte c√≥digo:

```js
$("#comprar").submit(function() {
    $.post(this.action, $(this).serialize());
});
```

Por estarmos usando um formulaÃÅrio sem√¢ntico, podemos simplesmente pedir para o jQuery pegar os dados desse formulaÃÅrio e enviaÃÅ-lo como o navegador faria, poreÃÅm de forma assiÃÅncrona.

Quando come√ßamos por um cen√°rio mais limitado, h√° a tend√™ncia natural em solucion√°-lo adequadamente. Isso nos forcÃßa a pensar e desenvolver de uma forma que favorece um HTML mais semaÃÇntico e desacoplado de CSS e JavaScript. Ganhamos naÃÉo apenas um site que funciona bem para todos; ganhamos tambeÃÅm um coÃÅdigo **mais limpo e faÃÅcil de manter**.

>Mas quais s√£o os cen√°rios mais limitados? Por onde come√ßar? Como acrescentar funcionalidades sem quebrar o que j√° t√≠nhamos? Veremos isso adiante! üôÉ

### Por onde come√ßar?

Come√ßar a desenvolver pensando em **Progressive Enhancement** influencia os mais diversos pontos dentro de um projeto. Seguindo novamente um exemplo dado pelo **Luiz Real**, se formos desenvolver um site para divulgar um produto, podemos pensar, antes de mais nada em:

- Qual nosso p√∫blico-alvo?
- Ser√° que precisamos nos procupar com navegadores antigos?
- Qual a parcela de visitantes do meu site que vir√° de dispositivos m√≥veis?
- Qu√£o importante √© a integra√ß√£o com redes sociais?
- O que posso oferecer para meus visitantes com configura√ß√µes mais limitadas?

Como podemos perceber, estas s√£o quest√µes que est√£o muito mais relacionadas ao contexto do neg√≥cio do que relacionados a quest√µes t√©cnicas. Ter as respostas para essas quest√µes √© muito relevante para nortear o processo de aplica√ß√£o do conceito de **Progressive Enhancement**.

Conseguimos perceber at√© aqui que o **Progressive Enhancement** n√£o √© apenas uma forma de desenvolver c√≥digos front-end. *√â uma forma diferente de pensar o desenvolvimento do produto como um todo.*

Sendo assim, uma poss√≠vel resposta para a nossa pergunta "Por onde come√ßar?" seria:

**Pelo planejamento do produto**

    Tendo bem claro os objetivos do produto, as decis√µes t√©cnicas tornam-se mais simples.

Um grande erro dos desenvolvedores, principalmente dos iniciantes, √© deixar em segundo plano pontos inerentes ao planejamento do projeto e partir diretamente para a codifica√ß√£o. Erro grave! 

Claro que em um cen√°rio real, algumas situa√ß√µes fogem do nosso controle, como p√∫blico-alvo pouco conhecido, influ√™ncia do cliente junto ao projeto e o or√ßamento com prazo limitado.

Mas ainda com esses potenciais empecilhos, √© poss√≠vel aplicar o **Progressive Enhancement**. Veja s√≥: 

- Se n√£o sabemos qual o cen√°rio mais limitado que vamos atender, podemos come√ßar pelo mais limitado.

- Se n√£o temos or√ßamento e/ou prazo suficiente para desenvolver todas as funcionalidade desejadas, podemos entregar as que atendem aos cen√°rios mais limitados primeiro.

- Se n√£o sabemos quais tecnologias os visitantes do site v√£o usar para acessar o conte√∫do, come√ßamos com o m√≠nimo poss√≠vel de tecnologias.


## Progressive Enhancement e HTML

Como sabemos, o HTML √© a base de toda p√°gina na Internet e, portanto, todo usu√°rio do nosso site, seja humano ou m√°quina, tem que entender pelo menos HTML; sempre podemos contar com ele.

>Vale ressaltar que atualmente todos os navegadores, em suas √∫ltimas vers√µes, trabalham com HTML5. 

Quando dizemos HTML5, na verdade, estamos falando de uma s√©rie de novas funcionalidades, como, novas tags, novos atributos, novas APIs, entre outros. S√£o tantos novos recursos, que os navegadores, em sua maioria, ainda n√£o implementam a especifica√ß√£o do HTML5 em sua totalidade.

Por√©m, a especifica√ß√£o do HTML j√° foi projetado pensando em **Progressive Enhancement**. Peguemos o exemplo abaixo para analisar:

```html
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Teste de HTML5</title>
    </head>
    <body>
        <header>
            <h1>P√°gina com HTML5</h1>
            <span>Bacana, n√©?</span>
        </header>
        <section>
            <h1>Hora atual</h1>
            <time>22:39</time>
            <p>Um controle de form novo:</p>
            <input type="range" min="1" max="10">
        </section>
    </body>
</html>
```

Logo no in√≠cio do c√≥digo, declaramos o DOCTYPE para indicar para o navegador que estamos utilizando a vers√£o mais recente do HTML, ou seja, que o navegador deve mostrar todo seu potencial.

E se o navegador n√£o implementar suporte a todos estes recursos? A especifica√ß√£o do HTML recomenda que:

- *Se um agente de usuaÃÅrio encontrar um elemento que naÃÉo reconhece, ele deve tentar renderizar seu conteuÃÅdo;*

- *Se um agente de usuaÃÅrio encontrar um atributo que naÃÉo reconhece, ele deve ignorar a declaracÃßaÃÉo completa deste atributo, isto eÃÅ, o atributo e seu valor;*

- *Se um agente de usuaÃÅrio encontrar um valor de atributo que naÃÉo reconhece, ele deve usar o valor padraÃÉo para aquele atributo.*

Mesmo que o navegador n√£o entenda exatamente o que estamos querendo dizer, ele vai mostrar o conte√∫do para o usu√°rio; **podemos incrementar a sem√¢ntica e a interatividade do nosso HTML sem quebrar os navegadores mais limitados!** A recomenda√ß√£o √© bem favor√°vel √† aplica√ß√£o do **Progressive Enhancement**.

No exemplo dado anteriormente, se o navegador n√£o suporta a tag `<time>` e o `input` do tipo `range`, ainda assim o usu√°rio ver√° a hora e um controle de formul√°rio (uma caixa de texto, que √© o controle de formul√°rio padr√£o).


## Progressive Enhancement e CSS

Tendo a nosso HTML como base bem definido, podemos come√ßar a implementar o design com CSS.

Assim como o HTML, o CSS √© uma tecnologia j√° antiga e que passou por uma grande evolu√ß√£o, culminando no que chamamos agora de **CSS 3**. Assim como o caso do HTML, os navegadores n√£o implementam suporte a todas as novidades, mesmo porque elas continuam vindo, mas os navegadores ignoram as propriedades desconhecidas, de modo que tamb√©m √© muito f√°cil ir incrementando nosso visual de acordo com as funcionalidades dispon√≠veis.

Al√©m disso, o CSS tem uma outra caracter√≠stica peculiar que facilita o **Progressive Enhancement**: quando uma propriedade aparece duplicada, apenas a √∫ltima declara√ß√£o √© considerada.

Esse comportamento permite fazer **Progressive Enhancement** de um jeito f√°cil: basta ir acrescentando as funcionalidades mais recentes abaixo das mais antigas! üëå

Quando pensamos em **Progressive Enhancement**, devemos pensar em dar a melhor experieÃÇncia possiÃÅvel para os cenaÃÅrios limitados. A maior parte dos sites que vamos desenvolver no nosso dia a dia precisaraÃÅ de CSS para ser visualmente agradaÃÅvel e atrair mais usuaÃÅrios. Ou seja, mesmo nos cenaÃÅrios mais limitados, jaÃÅ estaremos dependentes de CSS.

>A maioria dos requisitos de front-end que normalmente implementamos com JavaScript podem ser feitos apenas com CSS, ou seja, sem depender de mais uma tecnologia.


## Progressive Enhancement e JavaScript

Desenvolver pensando primeiro nos cenaÃÅrios mais limitados jaÃÅ evita que caiamos em certos tipos de armadilhas. No entanto, quando adicionamos JavaScript √†ÃÄ paÃÅgina, precisamos tomar certos cuidados para naÃÉo quebrar o trabalho jaÃÅ feito, assim como no CSS.

Da mesma forma que devemos pensar no CSS como algo a mais em uma paÃÅgina, devemos tambeÃÅm pensar no JavaScript dessa forma. Isso significa que, na medida do possiÃÅvel, o coÃÅdigo JavaScript naÃÉo deve interferir no seu HTML.

Tomemos o exemplo dado pelo Luiz Real. Em vez de fazer um link virar uma a√ß√£o em JavaScript como:

```html
<a href="#" onclick="maisProdutos()">Mais produtos</a>
```

Devemos preservar o HTML original.

```html
<a href="mais-produtos.html">Mais produtos</a>
```

E adicionar a funcionalidade JavaScript usando o proÃÅprio JavaScript.

```js
document.querySelector(‚Äô[href="mais-produtos.html"]‚Äô).addEventListener(‚Äôclick‚Äô, maisProdutos);
```

Dessa forma, nosso site continua funcionando perfeitamente, mesmo que o JavaScript apresente algum problema, e essa eÃÅ uma das principais vantagens do **Progressive Enhancement** para o seu desenvolvimento.

>Esse tipo de pensamento eÃÅ conhecido entre os desenvolvedores JavaScript como JavaScript naÃÉo-obstrutivo.

Um ponto que naÃÉo gera dores de cabecÃßa no HTML e no CSS mas que, no JavaScript, eÃÅ bastante complicado, eÃÅ lidar com funcionalidades faltantes. Vimos que, com relacÃßaÃÉo ao HTML, o navegador mostra informacÃßoÃÉes de tags desconhecidas e, com relacÃßaÃÉo ao CSS, o navegador ignora propriedades e valores naÃÉo suportados; o mesmo naÃÉo acontece com o JavaScript: qualquer comando que naÃÉo seja suportado pelo navegador geraraÃÅ um erro de JavaScript, consequentemente parando toda a execucÃßaÃÉo do coÃÅdigo.

Lidar com as limitacÃßoÃÉes e diferencÃßas entre os navegadores pode ser bastante trabalhoso. Por exemplo, para selecionar elementos da paÃÅgina, podemos usar a funcÃßaÃÉo `document.querySelector`, como  fizemos no exemplo anterior. No entanto, essa funcÃßaÃÉo naÃÉo estaÃÅ presente em todos os navegadores. Para que nosso coÃÅdigo funcione em todos os navegadores, podemos usar a funcÃßaÃÉo `document.getElementsByClassName`:

```js
var resultados = document.getElementsByClassName(‚Äôresultados‚Äô)[0];
```


## Entendi! Mas quando o Progressive Enhancement n√£o √© uma alternativa?

A abordagem do **Progressive Enhancement** resolve muitos problemas do desenvolvedor front-end ao forcÃßar o foco primeiro na parte mais importante de um site, que eÃÅ prover o conteuÃÅdo. No entanto, **Progressive Enhancement** tem suas desvantagens e nem sempre eÃÅ aplicaÃÅvel. 

Quando desenvolvemos pensando primeiro nos cenaÃÅrios mais limitados, conseguimos planejar nosso desenvolvimento de modo a tornar nosso site minimamente acessiÃÅvel nesses cenaÃÅrios. No entanto, isso pode ser restritivo para o processo criativo de desenvolvimento de um site.

√â possiÃÅvel desenvolver uma versaÃÉo mais simples, sem as funcionalidades principais, para os cenaÃÅrios mais limitados, usando **Progressive Enhancement**. Essa abordagem eÃÅ seguida, por exemplo, pelo Gmail, o servicÃßo de e-mail da Google. A versaÃÉo principal do cliente web eÃÅ desenvolvida usando recursos avancÃßados de JavaScript. Para simplificar o desenvolvimento dessa versaÃÉo e ainda permitir o acesso aos e-mails nos navegadores mais limitados, foi desenvolvida uma versaÃÉo baseada apenas em HTML.

Mesmo nos cenaÃÅrios em que **Progressive Enhancement** naÃÉo eÃÅ aplicaÃÅvel, eÃÅ interessante ter em mente as preocupacÃßoÃÉes dessa forma de desenvolvimento. Desenvolver para a web eÃÅ desenvolver para todos, independente de plataforma, navegador, liÃÅngua e capacidades, e essa eÃÅ a principal preocupacÃßaÃÉo do **Progressive Enhancement**.